pipeline {
    agent any
     stages{
         stage('clone my code'){
               git 'https://github.com/dhumalparth/maven-project'
           }
         }
         {
         stage('compile my code')
         {
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn compile'
                   }
                   }
                   }
                   }
                   {
         stage('validate my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn validate'
                   }
                   }
                   }
                   }
                    {
         stage('Test my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn test'
                   }
                   }
                   }
                   }
                   {
         stage('Pakaging my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn package'
                   }
                   }
                   }
                   }
                   {
         stage('Verify my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn verify'
                   }
                   }
                   }
                   }
                   {
         stage('Install my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn install'
                   }
                   }
                   }
                   }
                   {
         stage('Deploy my package'){
           steps {
  sshagent (credentials: ['62d69efe-a17c-4d41-a036-b68dbff0b2d7']) {
    sh 'scp -i */target/*.war ec2-user@172.31.33.104:/usr/share/tomcat/webapps'
  }
}
                   }
                   }
                   }
