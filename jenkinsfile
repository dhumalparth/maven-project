pipeline {
    agent any
     stages{
         stage('clone my code'){
               git 'https://github.com/dhumalparth/maven-project'
           }
         }
         {
         stage('compile my code')
         agent {label 'mymave'}
         {
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn compile'
                   }
                   }
                   }
                   }
                   {
         stage('validate my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn validate'
                   }
                   }
                   }
                   }
                    {
         stage('Test my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn test'
                   }
                   }
                   }
                   }
                   {
         stage('Pakaging my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn package'
                   }
                   }
                   }
                   }
                   {
         stage('Verify my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn verify'
                   }
                   }
                   }
                   }
                   {
         stage('Install my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn install'
                   }
                   }
                   }
                   }
                   {
         stage('Deploy my package'){
           steps {
  sshagent (credentials: ['dcaad32b-fb4c-4261-bda1-2025beadc86b']) {
    sh 'scp -r StrictHostKeyChecking=no */target/*.war ec2-user@172.31.33.104:/var/lib/tomcat/webapps'
  }
}
                   }
                   }
                   }
