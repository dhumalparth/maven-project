pipeline {
    agent any
     stages{
         stage('clone my code'){
               git 'https://github.com/dhumalparth/maven-project'
           }
         }
         {
         stage('compile my code')
         {
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn compile'
                   }
                   }
                   }
                   }
                   {
         stage('validate my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn validate'
                   }
                   }
                   }
                   }
                    {
         stage('Test my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn test'
                   }
                   }
                   }
                   }
                   {
         stage('Pakaging my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn package'
                   }
                   }
                   }
                   }
                   {
         stage('Verify my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn verify'
                   }
                   }
                   }
                   }
                   {
         stage('Install my code'){
           steps {
               withMaven(maven : 'LocalMaven') {
                   sh 'mvn install'
                   }
                   }
                   }
                   }
                   {
         stage('Deploy my package'){
           steps {
 sshagent(['4e0363fc-1159-4404-a1aa-a896a6f00927']){
    sh 'scp -o StrictHostKeyChecking=no */target/*.war ec2-user@172.31.20.89:/var/lib/tomcat/webapps'
  }
}
                   }
                   }
                   }
